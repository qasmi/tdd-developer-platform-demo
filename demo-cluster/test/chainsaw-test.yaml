apiVersion: chainsaw.kyverno.io/v1alpha1
kind: Test
metadata:
  name: test-database-secret-dependency
spec:
  steps:
  - try:
    - apply:
        file: user-db.yaml
    - assert:
        resource:
            apiVersion: database.kubecon.io/v1alpha1
            kind: MariaDBInstance
            metadata:
              name: mariadb
              namespace: drupal-app
            status:
              (conditions[?type == 'Ready']):
              - status: 'True'
    #- assert:
    #    resource:
    #        apiVersion: v1
    #        kind: Secret
    #        metadata:
    #          name: mariadb
    #          namespace: drupal-app
    #        spec:
    #          data:
      #          db-password# ???